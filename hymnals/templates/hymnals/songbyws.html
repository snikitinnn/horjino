{% extends 'base.html' %}
{% load staticfiles %}

{% block content %}

 <style>
 #verticalRow {
     text-align: center;
}

table {
     table-layout: fixed; /* Фиксированная ширина ячеек */
     width: 600px; /* Ширина таблицы */
   }
.col1 { width: 160px; }
.coln { width: 15px; }

td, th {
     font-size: smaller;
     border: solid 1px #f4f4f4;
}

</style>

<div>
    <a name="top"></a>
    <ul class="nav">
        <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <i class="glyphicon glyphicon-menu-hamburger"></i> Меню</a>
            <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
                <li><a href="{% url 'hymnals:choir' chorus.id %}"><i class="glyphicon glyphicon-music"></i> Сборники гимнов</a></li>
                <li><a href="{% url 'hymnals:topic_chorus' chorus.id %}"><i class="glyphicon glyphicon-list-alt"></i> Тематический указатель</a></li>
                <li><a href="{% url 'hymnals:alphabet' chorus.id 'n' %}"><i class="glyphicon glyphicon-sort-by-alphabet"></i> Алфавитный указатель</a></li>
                <li><a href="{% url 'hymnals:ws_chorus' chorus.id %}"><i class="glyphicon glyphicon-calendar"></i> Список собраний</a></li>
            </ul>
        </li>
    </ul>
<div>
    <h2>{{ chorus.name }}</h2>
    <h3>Cтатистика спетых гимнов</h3>
</div>
<br>
{% if ws_list %}
    <table>
        <col class="col1">
        <col span="20" class="coln">

        <tr>
            <td id="verticalRow">Гимн \ Дата</td>
            {% for ws in ws_list %}
                {% if ws.Supper %}
                    <td id="verticalRow" bgcolor="#FADADD">{{ ws.Date|date:"n" }}</td>
                {% else %}
                    <td id="verticalRow" >{{ ws.Date|date:"n" }}</td>
                {% endif %}
            {% endfor %}
        </tr>
        <tr>
            <td id="verticalRow"></td>
            {% for ws in ws_list %}
                {% if ws.Supper %}
                    <td id="verticalRow" bgcolor="#FADADD"><a href="{% url 'hymnals:songbyws_one' chorus.id ws.id %}">{{ ws.Date|date:"j" }}</a></td>
                {% else %}
                    <td id="verticalRow"><a href="{% url 'hymnals:songbyws_one' chorus.id ws.id %}">{{ ws.Date|date:"j" }}</a></td>
                {% endif %}
            {% endfor %}
        </tr>
        {% for song_row in song_table %}
        {% for sws in song_row %}
            {% if forloop.first %}  
                {% if sws.song_count = 0 %}
                    <tr bgcolor="#FAFAD6">
                {% elif sws.song_count >= 3 %}
                    <tr bgcolor="#E6E6FF">
                {% else %}
                    <tr>
                {% endif %}
                    {% if chorus.id < 5 %}
                        <td bgcolor={{sws.hymnal.color}}>{{sws.Name}}</td>
                    {% else %}
                        {% if sws.before %}
                            <td>{{sws.Name}}</td>
                        {% else%}
                            <td bgcolor="#E7C25F">{{sws.Name}}</td> <!-- this song is new! -->
                        {% endif %}
                    {% endif %}
            {% else %}
                    {% if sws %}
                        {% if sws == 1 %}
                            <td id="verticalRow" bgcolor="#FADADD"></td> <!-- column for Supper -->
                        {% else %}
                            {% if sws == 2 %}
                                <td bgcolor="lightblue"></td> <!-- song case -->
<!--                                    <td bgcolor="#E7C25F"></td> this song is new! -->
                            {% else %}
                                <td bgcolor="#FFF5EE"></td> <!-- column for lack info -->
                            {% endif %}
                        {% endif %}
                    {% else %}
                         <td></td>
                    {% endif %}
            {% endif %}
        {% endfor %}
                    </tr>
        {% endfor %}
        {% if song_table|length > 30 %}
        <tr>
            <td id="verticalRow"></td>
            {% for ws in ws_list %}
                {% if ws.Supper %}
                    <td id="verticalRow" bgcolor="#FADADD">{{ ws.Date|date:"n" }}</td>
                {% else %}
                    <td id="verticalRow" >{{ ws.Date|date:"n" }}</td>
                {% endif %}
            {% endfor %}
        </tr>
        <tr>
            <td id="verticalRow">Гимн / Дата</td>
            {% for ws in ws_list %}
                {% if ws.Supper %}
                    <td id="verticalRow" bgcolor="#FADADD"><a href="{% url 'hymnals:songbyws_one' chorus.id ws.id %}">{{ ws.Date|date:"j" }}</a></td>
                {% else %}
                    <td id="verticalRow" ><a href="{% url 'hymnals:songbyws_one' chorus.id ws.id %}">{{ ws.Date|date:"j" }}</a></td>
                {% endif %}
            {% endfor %}
        </tr>
    </table>
            <br>
            <a class="btn btn-primary" href="#top"><i class="glyphicon glyphicon-arrow-up"></i> Наверх</a>
        {% else %}
    </table>
            <br>
            <a class="btn btn-primary" href="{% url 'hymnals:songbyws' chorus.id %}"><i class="glyphicon glyphicon-stats"></i> Статистика</a>
        {% endif %}

{% else %}
    <p class="text-warning">Исполненных гимнов в базе нет.</p>
{% endif %}

</div>
{% endblock content%}